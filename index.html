<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>New Year Card</title>
  <meta name="description" content="A tiny brutalist New Year greeting. Tap for confetti." />

  <style>
    :root{
      --bg:#000;
      --fg:#fff;
      --muted:rgba(255,255,255,.65);
      --grid-gap: clamp(14px, 2.2vw, 22px);
    }

    /* brutalist-ish system stack; falls back well on iOS/Android */
    html,body{height:100%;}
    body{
      margin:0;
      background:var(--bg);
      color:var(--fg);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      overflow:hidden;
      -webkit-font-smoothing: antialiased;
      text-rendering: geometricPrecision;
    }

    /* Swiss-ish grid layout (simple + responsive) */
    .wrap{
      position:relative;
      height:100%;
      padding: max(18px, env(safe-area-inset-top)) max(18px, env(safe-area-inset-right))
               max(18px, env(safe-area-inset-bottom)) max(18px, env(safe-area-inset-left));
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: var(--grid-gap);
      align-items:start;
    }

    header{
      grid-column: 1 / -1;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }

    .kicker{
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size: 12px;
      color: var(--muted);
    }

    h1{
      margin:0;
      font-size: clamp(34px, 6vw, 64px);
      line-height: .95;
      letter-spacing: -0.02em;
      font-weight: 700;
    }

    .msg{
      grid-column: 1 / -1;
      max-width: 48ch;
      font-size: clamp(16px, 2.2vw, 20px);
      line-height: 1.35;
      color: rgba(255,255,255,.92);
    }

    .meta{
      grid-column: 1 / -1;
      display:flex;
      flex-wrap:wrap;
      gap: 10px 18px;
      margin-top: 6px;
      color: var(--muted);
      font-size: 13px;
    }

    .tap{
      position:absolute;
      left: 18px;
      bottom: 18px;
      right: 18px;
      color: rgba(255,255,255,.65);
      font-size: 12px;
      letter-spacing:.06em;
      text-transform:uppercase;
      pointer-events:none;
    }

    /* Confetti canvas always on top, but not blocking taps */
    canvas{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:none;
    }

    /* Subtle brutalist divider line */
    .line{
      width: 100%;
      height:1px;
      background: rgba(255,255,255,.18);
      margin-top: 4px;
    }
  </style>
</head>

<body>
  <div class="wrap" id="wrap">
    <canvas id="confetti"></canvas>

    <header>
      <div class="kicker" id="kicker"></div>
      <h1 id="title">Happy New Year.</h1>
      <div class="line"></div>
    </header>

    <div class="msg" id="message">
      Wishing you a clean start and loud momentum. <br/>
      Tap anywhere for confetti.
    </div>

    <!-- <div class="meta">
      <div id="toLine">To: Friend</div>
      <div id="fromLine">From: Ingsa</div>
      <div id="yearLine">Year: 2026</div>
    </div> -->

    <div class="tap">Tap / Click anywhere â†’ confetti</div>
  </div>

  <script>
    /**
     * Personalization via URL parameters:
     *   ?to=Annie&from=Ingsa&msg=Big%20energy%20in%202026!&year=2026
     */
    const params = new URLSearchParams(location.search);
    const to = params.get("to") || "Friend";
    const from = params.get("from") || "Ingsa";
    const msg = params.get("msg") || "Wishing you a clean start and loud momentum.\nTap anywhere for confetti.";
    const year = params.get("year") || "2026";
    const title = params.get("title") || "Happy New Year.";

    document.getElementById("title").textContent = title;
    document.getElementById("message").innerHTML = msg.replace(/\n/g, "<br/>");
    document.getElementById("toLine").textContent = `To: ${to}`;
    document.getElementById("fromLine").textContent = `From: ${from}`;
    document.getElementById("yearLine").textContent = `Year: ${year}`;

    // Ultra-light confetti (no libraries)
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d", { alpha: true });

    function resize(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      canvas.width = Math.floor(innerWidth * dpr);
      canvas.height = Math.floor(innerHeight * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    addEventListener("resize", resize, { passive: true });
    resize();

    const confettiPieces = [];
    let animating = false;

    // keep grayscale brutalist: white/gray only
    const COLORS = ["#fff", "rgba(255,255,255,.85)", "rgba(255,255,255,.65)"];

    function burst(x, y){
      const count = 90; // light enough for phones
      for(let i=0;i<count;i++){
        const angle = Math.random() * Math.PI * 2;
        const speed = 2 + Math.random() * 6;
        confettiPieces.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed - (2 + Math.random()*3),
          g: 0.16 + Math.random()*0.12,
          r: (Math.random()*6) + 2,     // size
          h: (Math.random()*10) + 6,    // size
          rot: Math.random() * Math.PI,
          vr: (Math.random() - 0.5) * 0.25,
          life: 0,
          ttl: 90 + Math.random()*40,
          color: COLORS[(Math.random()*COLORS.length)|0],
          shape: Math.random() < 0.25 ? "line" : "rect"
        });
      }
      if(!animating){
        animating = true;
        requestAnimationFrame(tick);
      }
      // tiny haptic on supported phones
      if (navigator.vibrate) navigator.vibrate(10);
    }

    function tick(){
      ctx.clearRect(0,0,innerWidth,innerHeight);

      for(let i=confettiPieces.length-1; i>=0; i--){
        const p = confettiPieces[i];
        p.life++;
        p.vy += p.g;
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;

        const alpha = Math.max(0, 1 - (p.life / p.ttl));
        ctx.globalAlpha = alpha;
        ctx.strokeStyle = p.color;
        ctx.fillStyle = p.color;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);

        if (p.shape === "line"){
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(-p.h, 0);
          ctx.lineTo(p.h, 0);
          ctx.stroke();
        } else {
          ctx.fillRect(-p.r, -p.h/2, p.r*2, p.h);
        }
        ctx.restore();

        // remove if out of life or far off screen
        if(p.life > p.ttl || p.y > innerHeight + 60 || p.x < -60 || p.x > innerWidth + 60){
          confettiPieces.splice(i,1);
        }
      }

      ctx.globalAlpha = 1;

      if(confettiPieces.length){
        requestAnimationFrame(tick);
      } else {
        animating = false;
      }
    }

    // Mobile-first interaction: tap anywhere
    // Use pointer events for both mouse + touch, passive for performance.
    const wrap = document.getElementById("wrap");

    wrap.addEventListener("pointerdown", (e) => {
      // prevent double-tap zoom on iOS Safari-ish behaviour
      // (we keep it minimal; no preventDefault needed for pointerdown)
      burst(e.clientX, e.clientY);
    }, { passive: true });

    // Optional: auto-burst once on load (tiny)
    setTimeout(() => burst(Math.min(120, innerWidth*0.25), Math.min(160, innerHeight*0.3)), 250);
  </script>
</body>
</html>
