<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Happy New Year</title>
  <meta name="description" content="A playful New Year card with confetti + neon motion." />

  <style>
    :root{
      --bg:#000;
      --fg:#fff;
      --muted:rgba(255,255,255,.68);
      --grid:rgba(255,255,255,.09);
      --grid-strong:rgba(255,255,255,.14);
      --maxw: 980px;
    }

    /* Reset */
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      overflow:hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Swiss grid background */
    .grid{
      position:fixed; inset:0;
      background-image:
        linear-gradient(var(--grid) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid) 1px, transparent 1px),
        linear-gradient(var(--grid-strong) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-strong) 1px, transparent 1px);
      background-size:
        24px 24px,
        24px 24px,
        120px 120px,
        120px 120px;
      background-position:
        0 0,
        0 0,
        0 0,
        0 0;
      pointer-events:none;
      opacity:.7;
    }

    /* Neon motion (lightweight CSS layers) */
    .neon{
      position:fixed; inset:-20%;
      pointer-events:none;
      filter: blur(28px) saturate(1.3);
      opacity:.85;
      transform: translateZ(0);
      will-change: transform;
    }
    .neon::before,
    .neon::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient( circle at 20% 30%, rgba(0,255,255,.45), transparent 40%),
        radial-gradient( circle at 75% 25%, rgba(255,0,200,.35), transparent 45%),
        radial-gradient( circle at 65% 75%, rgba(0,255,120,.28), transparent 45%),
        radial-gradient( circle at 25% 80%, rgba(255,180,0,.24), transparent 48%);
      mix-blend-mode: screen;
      transform: translate3d(0,0,0);
      animation: drift1 12s linear infinite;
    }
    .neon::after{
      opacity:.7;
      animation: drift2 16s linear infinite reverse;
    }
    @keyframes drift1{
      0%   { transform: translate3d(-2%, -1%, 0) scale(1.05) rotate(0deg); }
      50%  { transform: translate3d( 2%,  2%, 0) scale(1.08) rotate(8deg); }
      100% { transform: translate3d(-2%, -1%, 0) scale(1.05) rotate(0deg); }
    }
    @keyframes drift2{
      0%   { transform: translate3d( 2%,  1%, 0) scale(1.02) rotate(0deg); }
      50%  { transform: translate3d(-2%, -2%, 0) scale(1.06) rotate(-10deg); }
      100% { transform: translate3d( 2%,  1%, 0) scale(1.02) rotate(0deg); }
    }

    /* Subtle vignette to keep text readable */
    .vignette{
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(circle at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.35) 55%, rgba(0,0,0,.7) 100%);
    }

    /* Canvas on top */
    canvas#confetti{
      position:fixed; inset:0;
      width:100%; height:100%;
      pointer-events:none; /* interaction captured by document */
    }

    /* Content using Swiss grid layout */
    .wrap{
      position:relative;
      height:100%;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding: clamp(18px, 4vw, 56px);
      padding-top: clamp(22px, 6vh, 72px);
    }

    .content{
      width:min(var(--maxw), 100%);
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 16px;
    }

    .headline{
      grid-column: 1 / -1;
      letter-spacing:-0.03em;
      line-height:1.02;
      font-size: clamp(44px, 8vw, 84px);
      margin:0 0 10px 0;
    }

    .sub{
      grid-column: 1 / span 8;
      font-size: clamp(14px, 2.4vw, 18px);
      line-height:1.55;
      color: var(--muted);
      margin:0;
    }

    .meta{
      grid-column: 1 / span 6;
      margin-top: 22px;
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      align-items:center;
      color: var(--muted);
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: .12em;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 10px 12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(6px);
    }

    /* Instruction line for mobile */
    .hint{
      grid-column: 1 / span 7;
      margin-top: 14px;
      font-size: 13px;
      color: rgba(255,255,255,.55);
      letter-spacing: .02em;
    }

    /* Small footer */
    .footer{
      position:fixed;
      left: clamp(18px, 4vw, 56px);
      bottom: clamp(16px, 3vw, 40px);
      color: rgba(255,255,255,.35);
      font-size: 12px;
      letter-spacing:.02em;
      user-select:none;
    }

    /* Reduce motion preference */
    @media (prefers-reduced-motion: reduce){
      .neon::before,.neon::after{ animation:none; }
    }
  </style>
</head>

<body>
  <div class="neon" aria-hidden="true"></div>
  <div class="grid" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>

  <canvas id="confetti"></canvas>

  <main class="wrap">
    <section class="content">
      <h1 class="headline" id="title">Happy New Year, friend.</h1>

      <p class="sub" id="message">
        Wishing you a year of momentum, good health, and clean new beginnings.
        Here’s a small burst of joy from my corner of the world.
      </p>

      <div class="meta" aria-label="Details">
        <div class="pill"><span>2026</span><span style="opacity:.6">/</span><span id="toName">for you</span></div>
        <div class="pill"><span id="fromName">— Ingsa</span></div>
      </div>

      <div class="hint" id="hint">
        Move your cursor to spray confetti. On phone: tap/drag anywhere.
      </div>
    </section>
  </main>

  <div class="footer">Built with love + a little chaos.</div>

  <script>
    // ----------------------------
    // Personalization via URL params:
    // ?to=Alex&from=Ingsa&msg=Your%20message%20here
    // ----------------------------
    const params = new URLSearchParams(location.search);
    const to = params.get("to");
    const from = params.get("from");
    const msg = params.get("msg");
    const year = params.get("year");

    const toNameEl = document.getElementById("toName");
    const fromNameEl = document.getElementById("fromName");
    const msgEl = document.getElementById("message");
    const titleEl = document.getElementById("title");

    if (to && to.trim()) {
      toNameEl.textContent = to.trim();
      titleEl.textContent = `Happy New Year, ${to.trim()}.`;
    }
    if (from && from.trim()) fromNameEl.textContent = `— ${from.trim()}`;
    if (msg && msg.trim()) msgEl.textContent = msg.trim();
    if (year && year.trim()) {
      // If you pass ?year=2026 it replaces "2026" in the pill (kept simple)
      document.querySelector(".meta .pill span").textContent = year.trim();
    }

    // ----------------------------
    // Lightweight confetti
    // - Uses a single canvas
    // - Caps particle count
    // - Optimized drawing
    // - Works with mouse + touch
    // ----------------------------
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d", { alpha: true });

    function resize() {
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1)); // cap DPR
      canvas.width = Math.floor(innerWidth * dpr);
      canvas.height = Math.floor(innerHeight * dpr);
      canvas.style.width = innerWidth + "px";
      canvas.style.height = innerHeight + "px";
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    addEventListener("resize", resize, { passive: true });
    resize();

    // Neon-ish palette (confetti only; background stays B/W grid + neon glow)
    const COLORS = ["#00F5FF", "#FF2BD6", "#7CFF00", "#FFD400", "#A56CFF", "#FFFFFF"];

    const particles = [];
    const MAX_PARTICLES = 650;      // keep safe for laptops
    const EMIT_PER_EVENT = 12;      // confetti per move/tap
    const GRAVITY = 720;            // px/s^2
    const DRAG = 0.985;

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function emit(x, y, amount){
      for (let i = 0; i < amount; i++){
        if (particles.length >= MAX_PARTICLES) particles.shift();

        const angle = rand(-Math.PI, 0);        // spray upward
        const speed = rand(220, 720);
        const vx = Math.cos(angle) * speed + rand(-120, 120);
        const vy = Math.sin(angle) * speed - rand(80, 160);

        particles.push({
          x, y,
          vx, vy,
          w: rand(3, 7),
          h: rand(5, 11),
          r: rand(0, Math.PI),
          vr: rand(-6, 6),
          life: rand(0.75, 1.35),
          age: 0,
          color: COLORS[(Math.random() * COLORS.length) | 0],
        });
      }
    }

    let lastEmit = 0;
    function throttledEmit(x, y){
      const now = performance.now();
      if (now - lastEmit < 16) return; // ~60fps throttle
      lastEmit = now;
      emit(x, y, EMIT_PER_EVENT);
    }

    // Mouse
    addEventListener("mousemove", (e) => {
      throttledEmit(e.clientX, e.clientY);
    }, { passive: true });

    // Touch (mobile): tap + drag
    addEventListener("touchstart", (e) => {
      const t = e.touches && e.touches[0];
      if (!t) return;
      throttledEmit(t.clientX, t.clientY);
    }, { passive: true });

    addEventListener("touchmove", (e) => {
      const t = e.touches && e.touches[0];
      if (!t) return;
      throttledEmit(t.clientX, t.clientY);
    }, { passive: true });

    // Optional: quick burst on click/tap
    addEventListener("click", (e) => emit(e.clientX, e.clientY, 26), { passive: true });

    let lastTime = performance.now();
    function tick(t){
      const dt = Math.min(0.033, (t - lastTime) / 1000);
      lastTime = t;

      ctx.clearRect(0, 0, innerWidth, innerHeight);

      for (let i = particles.length - 1; i >= 0; i--){
        const p = particles[i];
        p.age += dt;
        if (p.age >= p.life){
          particles.splice(i, 1);
          continue;
        }

        // physics
        p.vx *= DRAG;
        p.vy = p.vy * DRAG + GRAVITY * dt;

        p.x += p.vx * dt;
        p.y += p.vy * dt;
        p.r += p.vr * dt;

        // fade out near the end
        const fade = 1 - (p.age / p.life);
        const alpha = Math.max(0, Math.min(1, fade));

        ctx.save();
        ctx.globalAlpha = alpha;
        ctx.translate(p.x, p.y);
        ctx.rotate(p.r);

        // draw as small rectangle confetti
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);

        ctx.restore();
      }

      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);

    // Small performance hint for slower devices:
    // If you want it even lighter, reduce MAX_PARTICLES to ~350 and EMIT_PER_EVENT to ~8.
  </script>
</body>
</html>
